swagger: "2.0"
info:
  title: "Payln API"
  description: "Rediscovery Bitcoin payment."
  version: "1.0.0"
# host: "localhost:6780"
host: "payln-staging.onrender.com"
basePath: ""
schemes:
  - "https"
  - "http"
consumes:
  - "application/json"
produces:
  - "application/json"
securityDefinitions:
  Bearer:
    type: apiKey
    name: Authorization
    in: header
paths:
  /businesses:
    post:
      summary: Create a new business
      description: Create a new business with the provided information.
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: "#/definitions/CreateBusinessRequest"
      responses:
        201:
          description: OK.
          schema:
            type: object
            properties:
              status:
                type: string
              data:
                type: object
                properties:
                  message:
                    type: string
                  result:
                    type: object
                    properties:
                      business:
                        $ref: "#/definitions/Business"
        400:
          description: Bad Request.
          schema:
            $ref: "#/definitions/BadRequestErrorResponse"
        401:
          description: Unauthorized.
          schema:
            $ref: "#/definitions/ErrorResponse"
        404:
          description: Not Found.
          schema:
            $ref: "#/definitions/ErrorResponse"
        500:
          description: Internal server error.
          schema:
            $ref: "#/definitions/ErrorResponse"
      security:
        - Bearer: []

  /businesses/complete-business-creation:
    patch:
      summary: Complete business creation
      description: Complete the creation of a business by providing additional details.
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: "#/definitions/CompleteBusinessCreationRequest"
      responses:
        200:
          description: OK.
          schema:
            type: object
            properties:
              status:
                type: string
              data:
                type: object
                properties:
                  message:
                    type: string
                  result:
                    type: object
                    properties:
                      business:
                        $ref: "#/definitions/Business"
        400:
          description: Bad Request.
          schema:
            $ref: "#/definitions/BadRequestErrorResponse"
        401:
          description: Unauthorized.
          schema:
            $ref: "#/definitions/ErrorResponse"
        404:
          description: Not Found.
          schema:
            $ref: "#/definitions/ErrorResponse"
        500:
          description: Internal server error.
          schema:
            $ref: "#/definitions/ErrorResponse"
      security:
        - Bearer: []

  /businesses/{business_id}:
    patch:
      summary: Update a business
      description: Update a business with partial data.
      parameters:
        - name: business_id
          in: path
          required: true
          type: string
          format: uuid
          description: Unique identifier for the business.
        - name: body
          in: body
          required: true
          schema:
            $ref: "#/definitions/UpdateBusinessRequest"
      responses:
        200:
          description: OK.
          schema:
            type: object
            properties:
              status:
                type: string
              data:
                type: object
                properties:
                  message:
                    type: string
                  result:
                    type: object
                    properties:
                      business:
                        $ref: "#/definitions/Business"
        400:
          description: Bad Request.
          schema:
            $ref: "#/definitions/BadRequestErrorResponse"
        401:
          description: Unauthorized.
          schema:
            $ref: "#/definitions/ErrorResponse"
        404:
          description: Not Found.
          schema:
            $ref: "#/definitions/ErrorResponse"
        500:
          description: Internal server error.
          schema:
            $ref: "#/definitions/ErrorResponse"

  /auth/signup:
    post:
      summary: Sign up a new user
      description: Create a new user with the provided information.
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: "#/definitions/SignUpUserRequest" 
      responses:
        201:
          description: OK.
          schema:
            type: object
            properties:
              status:
                type: string
              data:
                type: object
                properties:
                  message:
                    type: string
                  result:
                    type: object
                    properties:
                      user:
                        $ref: "#/definitions/User"
        400:
          description: Bad Request.
          schema:
            $ref: "#/definitions/BadRequestErrorResponse"
        500:
          description: Internal server error.
          schema:
            $ref: "#/definitions/ErrorResponse"

  /auth/login:
    post:
      summary: User login
      description: Authenticate the user with email and password.
      parameters:
        - name: body
          in: body
          required: true
          schema:
            type: object
            properties:
              email:
                type: string
                format: email
                description: User's email address.
              password:
                type: string
                minLength: 8
                description: User's password.
            required:
              - email
              - password
      responses:
        200:
          description: OK.
          schema:
            type: object
            properties:
              status:
                type: string
              data:
                type: object
                properties:
                  message:
                    type: string
                  result:
                    type: object
                    properties:
                      user:
                        $ref: "#/definitions/User"
                      access_token:
                        type: string
        400:
          description: Bad Request.
          schema:
            $ref: "#/definitions/BadRequestErrorResponse"
        401:
          description: Unauthorized.
          schema:
            $ref: "#/definitions/ErrorResponse"
        403:
          description: Forbidden.
          schema:
            $ref: "#/definitions/ErrorResponse"
        500:
          description: Internal server error.
          schema:
            $ref: "#/definitions/ErrorResponse"


  /users/email-verification:
    post:
      summary: Verify user's email
      description: Verify the user's email using OTP.
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: "#/definitions/EmailVerificationRequest"
      responses:
        201:
          description: OK.
          schema:
            type: object
            properties:
              status:
                type: string
              data:
                type: object
                properties:
                  message:
                    type: string
                  result:
                    type: object
                    properties:
                      user:
                        $ref: "#/definitions/User"
                      access_token:
                        type: string
        400:
          description: Bad Request.
          schema:
            $ref: "#/definitions/BadRequestErrorResponse"
        401:
          description: Unauthorized.
          schema:
            $ref: "#/definitions/ErrorResponse"
        404:
          description: Not Found.
          schema:
            $ref: "#/definitions/ErrorResponse"
        500:
          description: Internal server error.
          schema:
            $ref: "#/definitions/ErrorResponse"

  /users/send-email-verification:
    post:
      summary: Send email verification
      description: Send email verification to the specified email address.
      parameters:
        - name: body
          in: body
          required: true
          schema:
            type: object
            properties:
              email:
                type: string
                format: email
                description: Email address to which the verification email will be sent.
            required:
              - email
      responses:
        201:
          description: OK.
          schema:
            type: object
            properties:
              status:
                type: string
              data:
                type: object
                properties:
                  message:
                    type: string
        400:
          description: Bad Request.
          schema:
            $ref: "#/definitions/BadRequestErrorResponse"
        404:
          description: Not Found.
          schema:
            $ref: "#/definitions/ErrorResponse"
        500:
          description: Internal server error.
          schema:
            $ref: "#/definitions/ErrorResponse"

definitions:
  CreateBusinessRequest:
    type: object
    properties:
      name:
        type: string
        description: Business name.
      description:
        type: string
        description: Business description.
      general_email:
        type: string
        format: email
        description: General email address of the business.
      website_url:
        type: string
        format: uri
        description: URL of the business website.
    required:
      - name
      - description
      - general_email
      - website_url

  Business:
    type: object
    properties:
      id:
        type: string
        format: uuid
        description: Unique identifier for the business.
      owner_id:
        type: integer
        description: Owner's ID for the business.
      name:
        type: string
        description: Business name.
      description:
        type: string
        description: Business description.
      general_email:
        type: string
        format: email
        description: General email address of the business.
      dispute_email:
        type: string
        format: email
        description: Dispute email address of the business (default '').
      phone_number:
        type: string
        description: Phone number of the business (default '').
      address:
        type: string
        description: Business address (default '').
      city:
        type: string
        description: City where the business is located (default '').
      state:
        type: string
        description: State where the business is located (default '').
      postal_code:
        type: string
        description: Postal code of the business location (default '').
      country:
        type: string
        description: Country where the business is located (default '').
      website_url:
        type: string
        format: uri
        description: URL of the business website (default '').
      completed_onboarding:
        type: boolean
        description: Indicates whether the business has completed onboarding (default `false`).
      created_at:
        type: string
        format: date-time
        description: Date and time when the business was created (default now()).
      updated_at:
        type: string
        format: date-time
        description: Date and time when the business was last updated (default now()).
      is_active:
        type: boolean
        description: Indicates whether the business is active (default `true`).
    required:
      - id
      - owner_id
      - name
      - description
      - general_email
      - dispute_email
      - phone_number
      - address
      - city
      - state
      - postal_code
      - country
      - website_url
      - completed_onboarding
      - created_at
      - updated_at
      - is_active

  BadRequestErrorResponse:
    type: object
    properties:
      errors:
        type: array
        items:
          type: object
          properties:
            msg:
              type: string
              description: Error message.
            type:
              type: string
              description: Error type.
            value:
              type: string
              description: Error value.
            path:
              type: string
              description: field path in JSON object.
            location:
              type: string
              description: Error happened where in request.
    required:
      - errors

  ErrorResponse:
    type: object
    properties:
      status:
        type: string
      error:
        type: object
        properties:
          message:
            type: string

  SignUpUserRequest:
    type: object
    properties:
      first_name:
        type: string
        description: User's first name.
      last_name:
        type: string
        description: User's last name.
      email:
        type: string
        format: email
        description: User's email address.
      password:
        type: string
        minLength: 8
        description: User's password.
    required:
      - first_name
      - last_name
      - email
      - password

  User:
    type: object
    properties:
      id:
        type: number
        description: Unique identifier for the user.
      first_name:
        type: string
        description: User's first name.
      last_name:
        type: string
        description: User's last name.
      email:
        type: string
        format: email
        description: User's email address.
      created_at:
        type: string
        format: date-time
        description: time user was created.
      is_active:
        type: boolean
        description: Is user active/inactive.
      is_email_verified:
        type: boolean
        description: Is user's email verified as the owner.
    required:
      - id
      - first_name
      - last_name
      - email
      - created_at
      - is_active
      - is_email_verified

  EmailVerificationRequest:
    type: object
    properties:
      otp:
        type: string
        description: One-time password for email verification.
      user_id:
        type: integer
        description: User's ID for email verification.
    required:
      - otp
      - user_id

  CompleteBusinessCreationRequest:
    type: object
    properties:
      business_id:
        type: string
        format: uuid
        description: Unique identifier for the business.
      phone_number:
        type: string
        description: Phone number of the business.
      dispute_email:
        type: string
        format: email
        description: Dispute email address of the business.
      address:
        type: string
        description: Business address.
      city:
        type: string
        description: City where the business is located.
      state:
        type: string
        description: State where the business is located.
      postal_code:
        type: string
        description: Postal code of the business location.
      country:
        type: string
        description: Country where the business is located.
    required:
      - business_id
      - address
      - city
      - state
      - postal_code
      - country

  UpdateBusinessRequest:
    type: object
    properties:
      name:
        type: string
        description: Business name (optional).
      description:
        type: string
        description: Business description (optional).
      general_email:
        type: string
        format: email
        description: General email address of the business (optional).
      website_url:
        type: string
        format: uri
        description: URL of the business website (optional).
      phone_number:
        type: string
        description: Phone number of the business (optional).
      dispute_email:
        type: string
        format: email
        description: Dispute email address of the business (optional).
      address:
        type: string
        description: Business address (optional).
      city:
        type: string
        description: City where the business is located (optional).
      state:
        type: string
        description: State where the business is located (optional).
      postal_code:
        type: string
        description: Postal code of the business location (optional).
      country:
        type: string
        description: Country where the business is located (optional).

